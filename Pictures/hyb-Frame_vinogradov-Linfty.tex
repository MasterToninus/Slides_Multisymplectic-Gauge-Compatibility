%+------------------------------------------------------------------------+
%| Figure: Vinogradov-Zambon Linfinity algebra definition
%| Author: Antonio miti
%+------------------------------------------------------------------------+

\documentclass[border=3pt,beamer]{standalone}
\usepackage{tikz}
\usepackage{verbatim}
\usetikzlibrary{arrows,shapes}
\usepackage{tikz-cd}
\usetikzlibrary{calc}
\usepackage{amsmath}
\usepackage{amssymb}

\usepackage{stackengine}
\providecommand{\pairing}{\langle\cdot,\cdot\rangle}
\newcommand{\pair}[2]{\left({\stackanchor[5pt]{$#1$}{$#2$}}\right)}
\newcommand{\dd}{\ensuremath{d}}
\DeclareMathOperator{\cyc}{\scriptstyle\text{(cyc.)}}

\begin{document}
% For every picture that defines or uses external nodes, you'll have to
% apply the 'remember picture' style. To avoid some typing, we'll apply
% the style to all pictures.
\tikzstyle{every picture}+=[remember picture]

% By default all math in TikZ nodes are set in inline mode. Change this to
% displaystyle so that we don't get small fractions.
\everymath{\displaystyle}
\begin{minipage}[t]{\textwidth}
	\begin{minipage}[c]{0.4\textwidth}
			\begin{displaymath}
				L_\infty(E^n,\omega):=
				 \big(
				 \tikz[baseline]{
				            \node[fill=blue!20,anchor=base] (t1)
				            {$ \mathcal{V}_n$};
				        } 
					,
					 \tikz[baseline]{
				            \node[fill=green!20,anchor=base] (t2)
				            {$ \mu$};
					}
				\big)
			\end{displaymath}	
	\end{minipage}
	\begin{minipage}[t]{0.6\textwidth}
		\tikzstyle{na} = [baseline=-.5ex]
		%
		\tikz[na] \node[scale=0.5,coordinate,fill=blue!20,draw,circle] (n1) {};
		\onslide<3->{graded vector space}
		\onslide<4->{
			\begin{displaymath}\label{eq:VSpace}
			{\mathcal{V}^k} =
			\begin{cases}
				\mathfrak{X}(M)\oplus \Omega^{n-1}(M)  &\quad k=0,\\
				\Omega^{n-1+k}(M) &\quad -n+1 \leq k < 0.
			\end{cases}
			\end{displaymath}
		}
	\end{minipage}
	
	\vspace{1em}
	\begin{minipage}[t]{\textwidth}
		\tikzstyle{na} = [baseline=0ex]
		\tikz[na]\node [scale=0.5,coordinate,fill=green!20,draw,circle] (n2) {};	    
		   % 	multibrackets 		   % 	\footnote{$e_i = \pair{X_i}{\alpha_i} \in \mathfrak{X}(M)\oplus \Omega^{n-1}(M)$ ~~ $f_i \in \bigoplus_{k=0}^{n-2}\Omega^k(M)$.}
		\vspace{-1.5em}
		\begin{itemize}
			\item<5->[-] unary bracket:
				$\qquad~ \displaystyle \mu_1 \left(f\right) =   \dd f ~;$
			\item<6->[-] binary bracket:
				$\qquad\mu_2 \left(e_1,e_2\right) 	= [e_1,e_2]_\omega ~,$
			\item<6->[]
				$\qquad\qquad\qquad\qquad\quad	\mu_2 \left(e_1,f_2\right) = \frac{1}{2} \mathcal{L}_{X_1} f_2 ~;$
			\item<7->[-] ternary bracket:
				$~~\quad								\mu_3 (e_1, e_2, e_3) =
						-\frac{1}{3} \langle[e_1,e_2]_\omega,e_3 \rangle_+ + \cyc  ~,
				$
			\item<7->[]
				$\qquad\qquad\quad
						\mu_3 (f_1, e_2, e_3) =
						 -\frac{1}{6}
						\left(
						\frac{1}{2}(\iota_{X_1}\mathcal{L}_{X_2} 
						- \iota_{X_2}\mathcal{L}_{X_1}) + \iota_{[X_1,X_2]}
						\right)f_1
						~;
				$
			\item<8->[-] $k$-ary bracket for $k\geq 3$ an \emph{odd} integer: $\cdots$
		\end{itemize}	
	\end{minipage}
\end{minipage}
% Now it's time to draw some edges between the global nodes. Note that we
% have to apply the 'overlay' style.
\begin{tikzpicture}[overlay]
	\onslide<3->{\path[->,opacity=0.3] (n1) edge [bend right] (t1);}
	\onslide<4->{\draw[->,opacity=0.3, rounded corners=6mm] (n2.north) -- ($(n2.north) + (0,5mm)$)  -- (t2.south west);}
       % \path[->] (n3) edge [out=0, in=-90] (t3);
\end{tikzpicture}

\end{document}